%%%%%%并将原点定义为边坡坡趾最左侧的点，坡趾左侧三米处
%%%%%%%
global ro xo yo fa1 sto sth  stm rm B GG 
STT=[0.779512192092300   0.966439673817127   1.316199217752319   1.691641922008880 1.691641922008880]
figure('color','w') 
for i=1:1:3
   st=STT(i):0.001:STT(i+1);
   r=ro.*GG(i)*(exp((st-STT(i)).*tan(fai(i))));
   [xx,yy]=pol2cart(st,r);
   P3=plot(-xx-xo+32,-yy+yo+41.5,'color','b','LineWidth',1.0)
   hold on
end
%  %%%%%%%%%%%%%%绘制M法求出的圆弧滑动面，岩土参数与上述相同
  cx=4.9224946;
  cy=10.24757;
  t=-0.42:-0.01:-1.93;
  r=10.249108 ;
  center=[cx+5,cy+2.5];
 % center=[cx,cy];
  cirx=cos(t).*r+center(1);
  ciry=sin(t).*r+center(2);
  P4=plot(-cirx+32, ciry+41.5,'color','r','LineWidth',1.0,'LineStyle','--')
  hold on
% %%%%%%%%%%%%%%重新以对数螺旋线圆心处为坐标轴并绘制边坡模型。
 hold on
 A1=[-5+32,2.5+41.5]
 A2=[-2-5+32,1+2.5+41.5];
 A3=[-8-5+32,4+2.5+41.5];
 A4=[-12-5+32,6+2.5+41.5];%%%
 A5=[-12-5-5+32,6+2.5+41.5];%%%
 A6=[-12-5-5+32,4+7*tan(aa(2))+2.5+41.5];
 A7=[-12-5-5+32,1+2.5+41.5];
 A8=[-12-5-5+32,0+2.5+41.5]
 A9=[-12-5-5+32,-7.5+2.5+41.5]
 A10=[13-5+32,-7.5+2.5+41.5]
 A11=[13-5+32,-2.5+2.5+41.5]
 A12=[5-5+32,-2.5+2.5+41.5]
 DL=0.310085338194195
 DLX=[-DL-5+32,2.5+41.5]
  plot([A1(1) A2(1) A3(1) A4(1) A5(1) A6(1) A7(1) A8(1) A9(1) A10(1) A11(1) A12(1) A1(1)],...
       [A1(2) A2(2) A3(2) A4(2) A5(2) A6(2) A7(2) A8(2) A9(2) A10(2) A11(2) A12(2) A1(2)],'color','k','LineWidth',1);
  hold on
 plot([A3(1)  A6(1)], [A3(2)  A6(2)],'color','k','LineWidth',1);
  hold on
 plot([A7(1)  A2(1)], [A7(2)  A2(2)],'color','k','LineWidth',1);
   hold on
    plot([A1(1)  A8(1)], [A1(2)  A8(2)],'color','k','LineWidth',1);
   hold on
       plot([DLX(1)  A1(1)], [DLX(2)  A1(2)],'color','b','LineWidth',1);
   hold on
 %plot([A8(1)  A9(1)], [A8(2)  A9(2)],'color','k','LineWidth',2);
% figure('color','w')  
set(gca,'DataAspectRatio',[1,1,1])
axis([10,35,42,50])
% legend([P1 P2],{'塑性极限上限法，        Fs=3.787','Morgenstern-Price法，Fs=3.763'},'Location','northwest')
% legend('boxoff') 
% axis equal
% axis off
set(gca,'FontSize',20)
XX=[12.44811321
13.10849057
13.72169811
14.97169811
15.46698113
16.00943396
16.48113208
16.97641509
17.63679245
18.72169811
19.33490566
20.08962264
21.22169811
23.10849057
23.93396226
25.18396226
25.93867925
26.26886792
];
YY=[50.06315789
49.11578947
48.33684211
47.11578947
46.67368421
46.31578947
45.97894737
45.68421053
45.36842105
44.84210526
44.65263158
44.42105263
44.25263158
44.04210526
44.08421053
44.21052632
44.29473684
44.4
];
P2=plot(XX,YY,'-mo','MarkerEdgeColor','k',...
    'MarkerSize',4,'LineWidth',1)
%%%%%%%%%%%%%
hold on
X1=[14.47616942
14.82404678
15.07709316
15.3306309
16.00353774
16.81770833
17.26017099
17.53803066
18.14509631
18.91750197
19.50368514
20.68170204
21.69462461
22.92153105
23.86566431
25.21000393
26.38974057
]
Y1=[49.97916667
49.47916667
48.9375
48.4375
47.5
46.54166667
46.0625
45.625
45.10416667
44.60416667
44.3125
44.20833333
44.10416667
44.14583333
44.20833333
44.20833333
44.25
]
P1=plot(X1,Y1,'-bs','MarkerEdgeColor','g',...
    'MarkerSize',4,'LineWidth',1)
 legend([P1,P2,P3,P4],{'Zolfaghari','Cheng','Presented method','Geo-Slope'},'Location','northeast')
legend('boxoff') 